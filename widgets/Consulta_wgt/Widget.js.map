{"version":3,"sources":["../../../widgets/Consulta_wgt/Widget.js"],"names":["declare","_WidgetsInTemplateMixin","BaseWidget","lang","LayerInfos","Query","QueryTask","StatisticDefinition","SimpleFillSymbol","SimpleLineSymbol","Color","Message","BusyIndicator","baseClass","iniClause","layersMap","field_dep_nm_depa","field_dep_cd_depa","field_prov_nm_prov","field_prov_cd_prov","field_dist_nm_dist","field_dist_cd_dist","field_codigou_dm","field_concesion_dm","field_sustancia_dm","field_id","field_minero_informal","field_m_ruc","field_derecho_minero","field_id_unidad","field_tipo_persona","field_id_ubigeo_inei","controller_query","controller_layer_query","controller_ubigeo","temporal_class_results","postCreate","self_cw","inherited","arguments","_getAllLayers","getInstance","map","itemInfo","then","hitch","layerInfosObj","_showMessage","message","type","messagebox","titleLabel","nls","_widgetLabel","buttons","label","onClick","close","_cleanMap","_getDataByTipoPersona","id","config","layer_id_dc","feature_dc","getLayerInfoById","query","where","returnGeometry","returnDistinctValues","outFields","layerObject","queryFeatures","results","features","length","forEach","opt","document","createElement","value","i","attributes","text","select_tipo_persona_cw","add","selected","error_tipo_persona_count","error","error_tipo_persona","_getDataByDepartamento","layer_id_dep","feature_dep","queryTask","getUrl","orderByFields","execute","departamento_cw","error_departamento_count","error_departamento","_getDataByProvincia","evt","busyIndicator","show","cd_depa","target","distrito_cw","innerHTML","container_distrito_cw","classList","remove","container_provincia_cw","hide","contains","toggle","layer_id_prov","feature_prov","_zoomExtendSelected","provincia_cw","error_provincia_count","error_provincia","_getDataByDistrito","cd_prov","substring","layer_id_dist","feature_dist","error_distrito_count","error_distrito","_getDistritoSelected","cd_dist","whereDefinition","_addEventToLayerQuery","dojo","on","_setFormContainer","title","currentTarget","innerText","titulo_consulta","ListaCapasConsulta","hidden","nodeContainer_cw","toggleClass","node","dataset","dojoAttachPoint","includes","_returnListaCapasConsulta","_addEventToTabsOptions","_connectTabsWithOptionContainer","option","toLowerCase","container_option","_validateRucNumber","val","replace","_openPopupAutocamitcally","featureInfo","center","infoWindow","setFeatures","getInfoWindowAnchor","centerAt","_zoomDmExtentToMap","id_layer","layer_id_dm","feature","getLayerObject","response","graphics","clear","console","log","symbol","STYLE_NULL","STYLE_SOLID","ext","geometry","getExtent","graphic","setSymbol","setExtent","none_element","none_reference_map","error_query_feature","error_service","idService","queryExtent","res","count","extent","_applyQuery","ap_registros_encontrados_cw","_applyQueryDC","_applyQueryDM","_populateResultsDC","arrayResults","r","newRow","clone","ap_template_registros_resultados_cw","style","display","nodeTitle","getElementsByClassName","connect","_showPopupRowSelectedClick","fieldsList","push","field_dc_ruc","field_nombre_dm","fieldsListNode","join","appendChild","_showReinfos","parentElement","getAttribute","elm","removeChild","feature_sys","layer_id_dc_sys","setFilter","rownum","show_reinfos","data","lidata","index","lidataString","ulnode","create","addClass","none_element_pl","_populateResultsDM","_showPopupRowSelectedClickDM","id_row","id_layer_sys","error_none_geometry","_openPopupAutocamitcally2","featureLayer","getCentroid","whereDefinitionArray","input_ruc_dc_cw","ruc_dc","nombre_dc","input_nombre_dc_cw","tipo_persona_dc","codigou_dc","input_codigou_dc_cw","nombredm_dc","input_nombre_dm_dc_cw","ubigeo_dc","id_sys","result","rowcount","ap_indicador_resultados_cw","ap_titulo_resultados_cw","ap_none_resultados_opcion_cw","class_list_container_resultados","container_resultados_opcion_cw","ap_resultados_cw","click","codigou_dm","input_codigou_dm_cw","nombredm_dm","input_nombre_dm_cw","startup","domNode","parentNode","backgroundOpacity","onOpen","lyr_dc","lyr_dc_sys","lyr_dm","onClose","clean_map_question"],"mappings":"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","file":"Widget.js","sourcesContent":["import declare from 'dojo/_base/declare';\r\nimport _WidgetsInTemplateMixin from 'dijit/_WidgetsInTemplateMixin';\r\nimport BaseWidget from 'jimu/BaseWidget';\r\n// import query from \"dojo/query\";\r\nimport lang from 'dojo/_base/lang';\r\nimport LayerInfos from 'jimu/LayerInfos/LayerInfos';\r\nimport Query from \"esri/tasks/query\";\r\nimport QueryTask from \"esri/tasks/QueryTask\";\r\nimport StatisticDefinition from \"esri/tasks/StatisticDefinition\";\r\n// import InfoTemplate from \"esri/InfoTemplate\";\r\n// import FeatureLayer from \"esri/layers/FeatureLayer\";\r\nimport SimpleFillSymbol from \"esri/symbols/SimpleFillSymbol\";\r\nimport SimpleLineSymbol from \"esri/symbols/SimpleLineSymbol\";\r\nimport Color from \"esri/Color\";\r\n// import Graphic from \"esri/graphic\";\r\n\r\nimport Message from \"jimu/dijit/Message\";\r\n// import 'jimu/dijit/LoadingIndicator';\r\n// import 'jimu/dijit/LoadingShelter'\r\nimport BusyIndicator from 'esri/dijit/util/busyIndicator';\r\n// import domConstruct from 'dojo/dom-construct';\r\n// import on from 'dojo/on';\r\n// import domClass from \"dojo/dom-class\";\r\n// import \"dojo/domReady!\";\r\n\r\n// To create a widget, you need to derive from BaseWidget.\r\nexport default declare([BaseWidget, _WidgetsInTemplateMixin, Query,\r\n    QueryTask,\r\n    StatisticDefinition,\r\n    // FeatureLayer\r\n], {\r\n\r\n    // Custom widget code goes here\r\n\r\n    baseClass: 'consulta-wgt',\r\n    iniClause: '1=1',\r\n\r\n    layersMap: [],\r\n\r\n    field_dep_nm_depa: 'NM_DEPA',\r\n    field_dep_cd_depa: 'CD_DEPA',\r\n\r\n    field_prov_nm_prov: 'NM_PROV',\r\n    field_prov_cd_prov: 'CD_PROV',\r\n\r\n    field_dist_nm_dist: 'NM_DIST',\r\n    field_dist_cd_dist: 'CD_DIST',\r\n\r\n    field_codigou_dm: 'CODIGOU',\r\n    field_concesion_dm: 'CONCESION',\r\n    field_sustancia_dm: 'SUSTANCIA',\r\n\r\n    // Campos DC\r\n    field_id: 'ID', // Objectid del minero informal\r\n    field_minero_informal: 'MINERO_INFORMAL', // Nombre del minero informal\r\n    field_m_ruc: 'M_RUC', // RUC del minero informal\r\n    field_derecho_minero: 'DERECHO_MINERO', // Nombre del derecho mineroo\r\n    field_id_unidad: 'ID_UNIDAD', // Identificador del derecho minero (CODIGOU)\r\n    field_tipo_persona: 'TIPO_PERSONA', // Tipo de persona (natural, juridica)\r\n    field_id_ubigeo_inei: 'ID_UBIGEO_INEI', // Ubigeo\r\n\r\n    controller_query: '', // Permite identificar la opcion de consulta seleccionada\r\n    controller_layer_query: false,\r\n\r\n    controller_ubigeo: '',\r\n\r\n    temporal_class_results: '',\r\n\r\n    // add additional properties here\r\n\r\n    // methods to communication with app container:\r\n    postCreate() {\r\n        self_cw = this;\r\n        this.inherited(arguments);\r\n        // console.log('Consulta_wgt::postCreate');;\r\n        this._getAllLayers();\r\n    },\r\n\r\n    _getAllLayers() {\r\n        LayerInfos.getInstance(this.map, this.map.itemInfo)\r\n            .then(lang.hitch(this, function(layerInfosObj) {\r\n                this.layersMap = layerInfosObj;\r\n            }));\r\n    },\r\n\r\n    _showMessage(message, type = 'message') {\r\n        switch (type) {\r\n            case 'question':\r\n                let messagebox = new Message({\r\n                    type: type,\r\n                    titleLabel: `Widget ${this.nls._widgetLabel}: ${type}`,\r\n                    message: message,\r\n                    buttons: [{\r\n                        label: 'SI',\r\n                        onClick: lang.hitch(this, lang.hitch(this, function() {\r\n                            messagebox.close();\r\n                        }))\r\n                    }, {\r\n                        label: 'NO',\r\n                        onClick: lang.hitch(this, lang.hitch(this, function() {\r\n                            this._cleanMap();\r\n                            messagebox.close();\r\n                        }))\r\n                    }]\r\n                });\r\n\r\n                break;\r\n            default:\r\n                new Message({\r\n                    type: type,\r\n                    titleLabel: `Widget ${this.nls._widgetLabel}: ${type}`,\r\n                    message: message,\r\n                });\r\n                break;\r\n        }\r\n\r\n    },\r\n\r\n    // Metodos para agregar opciones a las etiquetas 'select'\r\n    _getDataByTipoPersona() {\r\n        let id = this.config.layer_id_dc\r\n        let feature_dc = this.layersMap.getLayerInfoById(id);\r\n        let query = new Query();\r\n        query.where = `${this.field_tipo_persona} IS NOT NULL`;\r\n        query.returnGeometry = false;\r\n        query.returnDistinctValues = true;\r\n        query.outFields = [this.field_tipo_persona];\r\n\r\n        feature_dc.layerObject.queryFeatures(query, function(results) {\r\n            let features = results.features;\r\n            if (features.length) {\r\n                features.forEach(i => {\r\n                    let opt = document.createElement(\"option\");\r\n                    opt.value = i.attributes[self_cw.field_tipo_persona];\r\n                    opt.text = i.attributes[self_cw.field_tipo_persona];\r\n                    self_cw.select_tipo_persona_cw.add(opt);\r\n                });\r\n                let opt = document.createElement(\"option\");\r\n                opt.value = '';\r\n                opt.text = 'Todos';\r\n                opt.selected = true;\r\n                self_cw.select_tipo_persona_cw.add(opt);\r\n            } else {\r\n                self_cw._showMessage(self_cw.nls.error_tipo_persona_count)\r\n            }\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_tipo_persona}\\n${error.message}`, type = 'error')\r\n        })\r\n    },\r\n\r\n    _getDataByDepartamento() {\r\n        let id = this.config.layer_id_dep\r\n        let feature_dep = this.layersMap.getLayerInfoById(id);\r\n        let queryTask = new QueryTask(feature_dep.getUrl());\r\n        let query = new Query();\r\n        query.where = `${this.field_dep_cd_depa} <> 99`;\r\n        query.returnGeometry = false;\r\n        query.outFields = [this.field_dep_nm_depa, this.field_dep_cd_depa];\r\n        query.orderByFields = [this.field_dep_nm_depa];\r\n        queryTask.execute(query, function(results) {\r\n            let features = results.features;\r\n            if (features.length) {\r\n                results.features.forEach(i => {\r\n                    let opt = document.createElement(\"option\");\r\n                    opt.value = i.attributes[self_cw.field_dep_cd_depa];\r\n                    opt.text = i.attributes[self_cw.field_dep_nm_depa];\r\n                    self_cw.departamento_cw.add(opt);\r\n                })\r\n                let opt = document.createElement(\"option\");\r\n                opt.value = '';\r\n                opt.text = 'Todos';\r\n                opt.selected = true;\r\n                self_cw.departamento_cw.add(opt);\r\n            } else {\r\n                self_cw._showMessage(self_cw.nls.error_departamento_count)\r\n            }\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_departamento}\\n${error.message}`, type = 'error')\r\n        })\r\n    },\r\n\r\n\r\n    _getDataByProvincia(evt) {\r\n        // Evento que se ejecuta cuando el usuario selecciona un departamento\r\n        // Carga las provincias pertenecientes al departamento seleccionado\r\n        // Realiza el zoom en el mapa al departamento seleccionado\r\n\r\n        // habilitar loader\r\n        this.busyIndicator.show();\r\n\r\n        // Obteniendo datos de la opcion seleccionada\r\n        let cd_depa = evt.target.value;\r\n\r\n        // Capturando el codigo de la provincia en el controlador de ubigeo\r\n        this.controller_ubigeo = cd_depa;\r\n\r\n        this.distrito_cw.innerHTML = '';\r\n        this.container_distrito_cw.classList.remove('active');\r\n\r\n        // Si se selecciono la opcion 'Todos' en el elemento 'Select' de departamentos\r\n        if (cd_depa == '') {\r\n            // Removemos el combo de provincias\r\n            this.container_provincia_cw.classList.remove('active');\r\n            // deshabilitar loader\r\n            this.busyIndicator.hide();\r\n            // Salimos del evento\r\n            return\r\n        }\r\n\r\n        // Si el contenedor de provincias no esta activo\r\n        if (!this.container_provincia_cw.classList.contains('active')) {\r\n            // Activar el contenedor de provincias\r\n            this.container_provincia_cw.classList.toggle('active');\r\n        };\r\n\r\n        // Obteniendo el LayerObject de provincias\r\n        let id = this.config.layer_id_prov\r\n        let feature_prov = this.layersMap.getLayerInfoById(id);\r\n        let queryTask = new QueryTask(feature_prov.getUrl());\r\n\r\n        // Definiendo el objeto Query para obtener las provincias del departamento\r\n        let query = new Query();\r\n        query.where = `${this.field_dep_cd_depa} = '${cd_depa}'`;\r\n        query.returnGeometry = false;\r\n        query.outFields = [this.field_prov_nm_prov, this.field_prov_cd_prov];\r\n        query.orderByFields = [this.field_prov_nm_prov];\r\n\r\n        // Ejecucion de consulta para obtener las opciones de provincias\r\n        queryTask.execute(query, function(results) {\r\n            // Zoom al departamento seleccionado\r\n            self_cw._zoomExtendSelected(self_cw.config.layer_id_dep, query.where);\r\n            let features = results.features;\r\n            // Si se encontraron resultados\r\n            if (features.length) {\r\n                self_cw.provincia_cw.innerHTML = '';\r\n                features.forEach(i => {\r\n                    let opt = document.createElement(\"option\");\r\n                    opt.value = i.attributes[self_cw.field_prov_cd_prov];\r\n                    opt.text = i.attributes[self_cw.field_prov_nm_prov];\r\n                    self_cw.provincia_cw.add(opt);\r\n                })\r\n                let opt = document.createElement(\"option\");\r\n                opt.value = '';\r\n                opt.text = 'Todos';\r\n                opt.selected = true;\r\n                self_cw.provincia_cw.add(opt);\r\n\r\n            } else {\r\n                // Notificar si no se encontraron elementos\r\n                self_cw._showMessage(`${self_cw.nls.error_provincia_count}`)\r\n            };\r\n            // deshabilitar loader\r\n            self_cw.busyIndicator.hide();\r\n        }, function(error) {\r\n            // Notificar si ocurrio algun error al momento de solicitar los datos\r\n            self_cw._showMessage(`${self_cw.nls.error_provincia}\\n${error.message}`, type = 'error')\r\n            self_cw.busyIndicator.hide();\r\n        });\r\n    },\r\n\r\n    _getDataByDistrito(evt) {\r\n        // Evento que se ejecuta cuando el usuario selecciona una provincia\r\n        // Carga las provincias pertenecientes a la provincia seleccionada\r\n        // Realiza el zoom en el mapa a la provincia seleccionada\r\n\r\n        // habilitar loader\r\n        this.busyIndicator.show();\r\n\r\n        // Obteniendo datos de la opcion seleccionada\r\n        let cd_prov = evt.target.value;\r\n\r\n        // Si se selecciono la opcion 'Todos' en el elemento 'Select' de provincias\r\n        if (cd_prov == '') {\r\n            // Anulamos los dos ultimos digitos del controlador de ubigeo\r\n            this.controller_ubigeo = this.controller_ubigeo.substring(0, 2);\r\n            // Ocultamos el selector de distritos\r\n            this.container_distrito_cw.classList.remove('active');\r\n            // deshabilitar loader\r\n            this.busyIndicator.hide();\r\n            return\r\n        }\r\n\r\n        // Si el contenedor de distrito no esta activo\r\n        if (!this.container_distrito_cw.classList.contains('active')) {\r\n            // Activar el contenedor de distrito\r\n            this.container_distrito_cw.classList.toggle('active');\r\n        }\r\n\r\n        // Capturando el codigo de la provincia en el controlador de ubigeo\r\n        this.controller_ubigeo = cd_prov;\r\n\r\n        // Obteniendo el LayerObject de distritos\r\n        let id = this.config.layer_id_dist;\r\n        let feature_dist = this.layersMap.getLayerInfoById(id);\r\n        let queryTask = new QueryTask(feature_dist.getUrl());\r\n\r\n        // Definiendo el objeto Query para obtener los distritos de la provincia\r\n        let query = new Query();\r\n        query.where = `${this.field_prov_cd_prov} = '${cd_prov}'`;\r\n        query.returnGeometry = false;\r\n        query.outFields = [this.field_dist_nm_dist, this.field_dist_cd_dist];\r\n        query.orderByFields = [this.field_dist_nm_dist];\r\n\r\n        // Ejecucion de consulta para obtener las opciones de distritos\r\n        queryTask.execute(query, function(results) {\r\n            // Zoom a la provincia seleccionada\r\n            self_cw._zoomExtendSelected(self_cw.config.layer_id_prov, query.where);\r\n            self_cw.distrito_cw.innerHTML = \"\";\r\n            let features = results.features;\r\n            // Si se encontraron resultados\r\n            if (features.length) {\r\n                features.forEach(i => {\r\n                    let opt = document.createElement(\"option\");\r\n                    opt.value = i.attributes[self_cw.field_dist_cd_dist];\r\n                    opt.text = i.attributes[self_cw.field_dist_nm_dist];\r\n                    self_cw.distrito_cw.add(opt);\r\n                })\r\n                let opt = document.createElement(\"option\");\r\n                opt.value = '';\r\n                opt.text = 'Todos';\r\n                opt.selected = true;\r\n                self_cw.distrito_cw.add(opt);\r\n            } else {\r\n                // Notificar si no se encontraron elementos\r\n                self_cw._showMessage(`${self_cw.nls.error_distrito_count}`);\r\n            };\r\n            // deshabilitar loader\r\n            self_cw.busyIndicator.hide();\r\n        }, function(error) {\r\n            // Notificar si ocurrio algun error al momento de solicitar los datos\r\n            self_cw._showMessage(`${self_cw.nls.error_distrito}\\n${error.message}`, type = 'error');\r\n            // deshabilitar loader\r\n            self_cw.busyIndicator.hide();\r\n        });\r\n\r\n    },\r\n\r\n    _getDistritoSelected(evt) {\r\n        // Evento que se ejecuta cuando el usuario selecciona una distrito\r\n        // Realiza el zoom en el mapa al distrito seleccionado\r\n        var cd_dist = evt.target.value;\r\n        whereDefinition = `${this.field_dist_cd_dist} = '${cd_dist}'`\r\n        if (cd_dist == '') {\r\n            this.controller_ubigeo = this.controller_ubigeo.substring(0, 4)\r\n            return\r\n        }\r\n        this.controller_ubigeo = cd_dist;\r\n        this._zoomExtendSelected(this.config.layer_id_dist, whereDefinition);\r\n    },\r\n\r\n    // Metodos dedicados al frontend del widget\r\n\r\n    _addEventToLayerQuery() {\r\n        dojo.query(\".capa_consulta_cw\").on('click', this._setFormContainer);\r\n    },\r\n\r\n    _setFormContainer(evt) {\r\n        var title = evt.currentTarget.innerText;\r\n\r\n        self_cw.controller_query = evt.currentTarget.id;\r\n        self_cw.titulo_consulta.innerText = title\r\n        self_cw.ListaCapasConsulta.hidden = true;\r\n\r\n        var nodeContainer_cw = dojo.query(\".container_cw\")\r\n        dojo.toggleClass(nodeContainer_cw[0], 'active')\r\n        dojo.query('.formulario_cw').forEach(function(node) {\r\n            if (node.dataset.dojoAttachPoint.includes(self_cw.controller_query)) {\r\n                node.hidden = false;\r\n            } else {\r\n                node.hidden = true;\r\n            }\r\n        })\r\n    },\r\n\r\n    _returnListaCapasConsulta() {\r\n        var nodeContainer_cw = dojo.query(\".container_cw\");\r\n        dojo.toggleClass(nodeContainer_cw[0], 'active');\r\n        this.ListaCapasConsulta.hidden = false;\r\n    },\r\n\r\n    _addEventToTabsOptions() {\r\n        dojo.query('.opcion_cw').on('click', this._connectTabsWithOptionContainer)\r\n    },\r\n\r\n    _connectTabsWithOptionContainer(evt) {\r\n        var option = evt.currentTarget.innerText.toLowerCase();\r\n        if (evt.currentTarget.classList.contains('is-active')) {\r\n            return\r\n        };\r\n        dojo.query('.opcion_cw').forEach(function(node) {\r\n            var container_option = self_cw[`${node.id}_${node.classList[0]}`]\r\n            if (node.innerText.toLowerCase() == option) {\r\n                node.classList.toggle('is-active')\r\n                container_option.classList.toggle('active')\r\n            } else {\r\n                node.classList.remove('is-active');\r\n                container_option.classList.remove('active')\r\n            }\r\n        });\r\n    },\r\n\r\n    _validateRucNumber(evt) {\r\n        var val = evt.currentTarget.value;\r\n        evt.currentTarget.value = val.replace(/[^0-9.]/g, '').replace(/(\\..*)\\./g, '$1');\r\n    },\r\n\r\n    // Interaccion con el mapa\r\n\r\n    _openPopupAutocamitcally(featureInfo, center, whereDefinition) {\r\n        var query = new Query();\r\n        query.where = whereDefinition;\r\n        featureInfo.layerObject.queryFeatures(query, function(results) {\r\n            self_cw.map.infoWindow.setFeatures(results.features);\r\n            self_cw.map.infoWindow.show(center, self_cw.map.getInfoWindowAnchor(center));\r\n            self_cw.map.centerAt(center);\r\n\r\n            // self_cw.map.infoWindow.show(center, self_cw.map.getInfoWindowAnchor(center));\r\n        });\r\n\r\n    },\r\n\r\n    _zoomDmExtentToMap(evt) {\r\n\r\n        // self_cw._applyQueryDM.click()\r\n        let id = evt.currentTarget.innerText;\r\n        query = new Query();\r\n        query.where = `${self_cw.field_codigou_dm} = '${id}'`\r\n        var id_layer = self_cw.config.layer_id_dm;\r\n        var feature = self_cw.layersMap.getLayerInfoById(id_layer);\r\n\r\n        feature.getLayerObject().then(function(response) {\r\n            self_cw.map.graphics.clear();\r\n            response.queryFeatures(query, function(results) {\r\n                console.log(results.features);\r\n                if (results.features.length) {\r\n                    let symbol = new SimpleFillSymbol(\r\n                        SimpleFillSymbol.STYLE_NULL,\r\n                        new SimpleLineSymbol(\r\n                            SimpleLineSymbol.STYLE_SOLID,\r\n                            new Color([255, 0, 0]), 3\r\n                        ),\r\n                        new Color([125, 125, 125, 0.35]));\r\n\r\n                    let ext = results.features[0].geometry.getExtent();\r\n\r\n                    let graphic = results.features[0].setSymbol(symbol)\r\n                    self_cw.map.graphics.add(graphic);\r\n                    self_cw.map.setExtent(ext, true);\r\n                } else {\r\n                    self_cw._showMessage(`${self_cw.nls.none_element} ${id}, ${self_cw.nls.none_reference_map}`);\r\n                }\r\n            }, function(error) {\r\n                self_cw._showMessage(`${self_cw.nls.error_query_feature} ${feature.title} (${query.where})\\n${error.message}`);\r\n            })\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_service} ${feature.title}\\n${error.message}`, type = 'error');\r\n        })\r\n    },\r\n\r\n    _zoomExtendSelected(idService, whereDefinition) {\r\n        var query = new Query();\r\n        query.where = whereDefinition;\r\n        var feature = this.layersMap.getLayerInfoById(idService);\r\n        feature.getLayerObject().then(function(results) {\r\n            results.queryExtent(query, function(res) {\r\n                if (res.count) {\r\n                    self_cw.map.setExtent(res.extent, true)\r\n                } else {\r\n                    self_cw._showMessage(`${self_cw.nls.none_element} ${whereDefinition}, ${self_cw.nls.none_reference_map}`);\r\n                }\r\n\r\n            }, function(error) {\r\n                self_cw._showMessage(`${self_cw.nls.error_query_feature} ${feature.title} (${query.where})\\n${error.message}`);\r\n            })\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_service} ${feature.title}\\n${error.message}`, type = 'error');\r\n        });\r\n    },\r\n\r\n    // _zoomExtentByQueryTask(url, query) {\r\n    //     let queryTask = new QueryTask(url);\r\n    //     queryTask.executeForExtent(query, function(results) {\r\n    //         if (results.count) {\r\n    //             let extent = results.extent;\r\n    //             this.map.setExtent(extent, true);\r\n    //         } else {\r\n    //             this._showMessage('');\r\n    //         }\r\n    //     }, function(error) {\r\n    //         this._showMessage('', type = 'error')\r\n    //     })\r\n    // },\r\n\r\n    // _zoomExtendByQueryExtent(layerObject, query) {\r\n    //     layerObject.queryExtent(query, function(results) {\r\n    //         if (results.count) {\r\n    //             this.map.setExtent(results.extent, true);\r\n    //         } else {\r\n    //             this._showMessage('');\r\n    //         }\r\n    //     }, function(error) {\r\n    //         this._showMessage('', type = 'error');\r\n    //     })\r\n    // },\r\n\r\n    // Proceso que realiza la consulta\r\n    _applyQuery(evt) {\r\n        this.busyIndicator.show();\r\n        self_cw.ap_registros_encontrados_cw.innerHTML = '';\r\n        switch (self_cw.controller_query) {\r\n            case 'dc':\r\n                self_cw._applyQueryDC();\r\n                // console.log('Ejecutando proces dc');\r\n                break;\r\n            case 'dm':\r\n                self_cw._applyQueryDM();\r\n                // console.log('Ejecutando proces dm');\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    },\r\n\r\n    _populateResultsDC(arrayResults) {\r\n        arrayResults.forEach(function(r, i) {\r\n            if (self_cw.temporal_class_results) {\r\n                var newRow = self_cw.temporal_class_results;\r\n            } else {\r\n                var newRow = dojo.clone(self_cw.ap_template_registros_resultados_cw);\r\n            }\r\n\r\n            newRow.style.display = 'block';\r\n\r\n            var nodeTitle = dojo.query('.title_registros_cw', newRow)[0]\r\n            newRow.getElementsByClassName('title_registros_cw')[0].innerText = `${i+1}. ${r[self_cw.field_minero_informal]}`;\r\n            newRow.getElementsByClassName('title_registros_cw')[0].id = r[self_cw.field_id];\r\n            dojo.connect(nodeTitle, 'onclick', self_cw._showPopupRowSelectedClick);\r\n\r\n            // Lista campos\r\n\r\n            var fieldsList = []\r\n            fieldsList.push(`<li>${self_cw.nls.field_dc_ruc}: ${r[self_cw.field_m_ruc]}</li>`);\r\n            fieldsList.push(`<li>${self_cw.nls.field_nombre_dm}: ${r[self_cw.field_derecho_minero]}</li>`);\r\n            fieldsList.push(`<li>${self_cw.nls.field_codigou_dm}: <span class=\"tag is-primary codigou_cw\">${r[self_cw.field_id_unidad]}<span></li>`);\r\n\r\n            fieldsListNode = fieldsList.join('');\r\n\r\n            newRow.getElementsByClassName('detalle_registros_resultados_cw')[0].innerHTML = fieldsListNode;\r\n\r\n            self_cw.ap_registros_encontrados_cw.appendChild(newRow);\r\n        });\r\n        dojo.query('.codigou_cw').on('click', self_cw._zoomDmExtentToMap);\r\n        this.busyIndicator.hide();\r\n    },\r\n\r\n    _showReinfos(evt) {\r\n        self_cw.busyIndicator.show();\r\n        let id = evt.currentTarget.parentElement.getAttribute('value');\r\n        var elm = dojo.query(`.ul_registro_dc_${id}`);\r\n\r\n        if (evt.currentTarget.parentElement.classList.contains('active')) {\r\n            if (elm.length) {\r\n                evt.currentTarget.parentElement.removeChild(elm[0])\r\n                evt.currentTarget.parentElement.classList.toggle('active')\r\n            }\r\n            self_cw.busyIndicator.hide();\r\n            return;\r\n        }\r\n\r\n        // let id = evt.currentTarget.parentElement.getAttribute('value');\r\n        let feature = self_cw.layersMap.getLayerInfoById(self_cw.config.layer_id_dc)\r\n\r\n        let feature_sys = self_cw.layersMap.getLayerInfoById(self_cw.config.layer_id_dc_sys)\r\n\r\n        let query = new Query();\r\n        query.where = `${self_cw.field_id_unidad} = '${id}'`;\r\n\r\n        feature.setFilter(query.where);\r\n        feature.show();\r\n\r\n        feature_sys.setFilter(query.where);\r\n        feature_sys.show();\r\n\r\n        // evt.currentTarget.parentElement.classList.toggle('active')\r\n\r\n        feature.getLayerObject().then(function(response) {\r\n            response.queryFeatures(query, function(results) {\r\n                if (results.features.length) {\r\n                    evt.target.parentElement.classList.toggle('active')\r\n                    let rownum = results.features.length;\r\n                    evt.target.innerText = `${self_cw.nls.show_reinfos} (${rownum})`\r\n                    let data = results.features.map((i) => i.attributes);\r\n                    let lidata = data.map((i, index) => `<li class=\"registro_dc\" id=\"${i[self_cw.field_id]}\"><a>${index + 1}. ${i[self_cw.field_m_ruc]} - ${i[self_cw.field_minero_informal]}</a></li>`)\r\n                    let lidataString = lidata.join('');\r\n                    let ulnode = dojo.create('ul');\r\n                    ulnode.innerHTML = lidataString;\r\n                    dojo.addClass(ulnode, `ul_registro_dc_${id}`)\r\n                    evt.target.parentElement.appendChild(ulnode);\r\n                    dojo.query('.registro_dc').on('click', self_cw._showPopupRowSelectedClick)\r\n                } else {\r\n                    self_cw._showMessage(self_cw.nls.none_element_pl);\r\n                };\r\n                self_cw.busyIndicator.hide();\r\n            }, function(error) {\r\n                self_cw._showMessage(`${self_cw.nls.error_query_feature} ${feature.title} (${query.where})\\n${error.message}`);\r\n                self_cw.busyIndicator.hide();\r\n            })\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_service} ${feature.title}\\n${error.message}`, type = 'error')\r\n            self_cw.busyIndicator.hide();\r\n        })\r\n    },\r\n\r\n    _populateResultsDM(arrayResults) {\r\n        arrayResults.forEach(function(r, i) {\r\n            if (self_cw.temporal_class_results) {\r\n                var newRow = self_cw.temporal_class_results;\r\n            } else {\r\n                var newRow = dojo.clone(self_cw.ap_template_registros_resultados_cw);\r\n            }\r\n\r\n            newRow.style.display = 'block';\r\n\r\n            var nodeTitle = dojo.query('.title_registros_cw', newRow)[0]\r\n            newRow.getElementsByClassName('title_registros_cw')[0].innerText = `${i+1}. ${self_cw.nls.field_codigou_dm}: ${r[self_cw.field_codigou_dm]}`;\r\n            newRow.getElementsByClassName('title_registros_cw')[0].id = r[self_cw.field_codigou_dm];\r\n            dojo.connect(nodeTitle, 'onclick', self_cw._showPopupRowSelectedClickDM);\r\n\r\n            // Lista campos\r\n\r\n            var fieldsList = []\r\n            fieldsList.push(`<li>${self_cw.nls.field_nombre_dm}: ${r[self_cw.field_concesion_dm]}</li>`);\r\n            fieldsList.push(`<li>${self_cw.nls.field_sustancia_dm}: ${r[self_cw.field_sustancia_dm]}</li>`);\r\n            fieldsList.push(`<li value=\"${r[self_cw.field_codigou_dm]}\"><span class=\"tag is-primary reinfos_cw\">${self_cw.nls.show_reinfos}<span></li>`);\r\n\r\n            fieldsListNode = fieldsList.join('');\r\n\r\n            newRow.getElementsByClassName('detalle_registros_resultados_cw')[0].innerHTML = fieldsListNode;\r\n\r\n\r\n\r\n            self_cw.ap_registros_encontrados_cw.appendChild(newRow);\r\n        })\r\n        dojo.query('.reinfos_cw').on('click', self_cw._showReinfos)\r\n        this.busyIndicator.hide();\r\n    },\r\n\r\n    _showPopupRowSelectedClick(evt) {\r\n        var id_row = evt.currentTarget.id;\r\n\r\n        var id_layer = self_cw.config.layer_id_dc;\r\n        var id_layer_sys = self_cw.config.layer_id_dc_sys;\r\n\r\n        var feature = self_cw.layersMap.getLayerInfoById(id_layer);\r\n        var feature_sys = self_cw.layersMap.getLayerInfoById(id_layer_sys);\r\n\r\n        var whereDefinition = `${self_cw.field_id} = ${id_row}`\r\n\r\n        feature_sys.setFilter(whereDefinition);\r\n\r\n        feature_sys.layerObject.queryFeatures(whereDefinition, function(results) {\r\n            var center = results.features[0].geometry;\r\n            if (!center) {\r\n                self_cw._showMessage(self_cw.nls.error_none_geometry)\r\n            }\r\n            self_cw._openPopupAutocamitcally(feature, center, whereDefinition);\r\n        })\r\n\r\n    },\r\n\r\n    _openPopupAutocamitcally2(featureLayer, center) {\r\n        self_cw.map.infoWindow.setFeatures(featureLayer.features);\r\n        self_cw.map.infoWindow.show(center, self_cw.map.getInfoWindowAnchor(center));\r\n        self_cw.map.centerAt(center);\r\n    },\r\n\r\n    _showPopupRowSelectedClickDM(evt) {\r\n        let id_row = evt.currentTarget.id;\r\n\r\n        let id_layer = self_cw.config.layer_id_dm;\r\n\r\n        let feature = self_cw.layersMap.getLayerInfoById(id_layer);\r\n\r\n        let whereDefinition = `${self_cw.field_codigou_dm} = '${id_row}'`\r\n\r\n        query = new Query();\r\n        query.where = whereDefinition;\r\n\r\n        // feature_sys.setFilter(whereDefinition);\r\n\r\n        feature.getLayerObject().then(function(response) {\r\n            response.queryFeatures(query, function(results) {\r\n                if (results.features.length) {\r\n                    let center = results.features[0].geometry.getCentroid();\r\n                    let ext = results.features[0].geometry.getExtent();\r\n                    self_cw._openPopupAutocamitcally2(results, center, query);\r\n                    self_cw.map.setExtent(ext, true);\r\n                }\r\n            }, function(error) {\r\n                self_cw._showMessage(`${self_cw.nls.error_query_feature} ${feature.title} (${query.where})\\n${error.message}`);\r\n            })\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_service} ${feature.title}\\n${error.message}`, type = 'error');\r\n        });\r\n\r\n        // feature_sys.layerObject.queryFeatures(whereDefinition, function(results) {\r\n        //     var center = results.features[0].geometry;\r\n        //     self_cw._openPopupAutocamitcally(feature, center, whereDefinition);\r\n        // })\r\n    },\r\n\r\n    _applyQueryDC() {\r\n        whereDefinitionArray = []\r\n\r\n        if (self_cw.input_ruc_dc_cw.value != '') {\r\n            var ruc_dc = `(${self_cw.field_m_ruc} like '%${self_cw.input_ruc_dc_cw.value}%')`;\r\n            whereDefinitionArray.push(ruc_dc);\r\n        }\r\n\r\n        var nombre_dc = `(lower(${self_cw.field_minero_informal}) like lower('%${self_cw.input_nombre_dc_cw.value}%'))`;\r\n        whereDefinitionArray.push(nombre_dc);\r\n\r\n        if (self_cw.select_tipo_persona_cw.value != '') {\r\n            var tipo_persona_dc = `(${self_cw.field_tipo_persona} like '%${self_cw.select_tipo_persona_cw.value}%')`;\r\n            whereDefinitionArray.push(tipo_persona_dc);\r\n        };\r\n\r\n        var codigou_dc = `(upper(${self_cw.field_id_unidad}) like upper('%${self_cw.input_codigou_dc_cw.value}%'))`;\r\n        whereDefinitionArray.push(codigou_dc);\r\n\r\n        var nombredm_dc = `(lower(${self_cw.field_derecho_minero}) like lower('%${self_cw.input_nombre_dm_dc_cw.value}%'))`;\r\n        whereDefinitionArray.push(nombredm_dc);\r\n\r\n        var ubigeo_dc = `(${self_cw.field_id_ubigeo_inei} like '${self_cw.controller_ubigeo}%')`;\r\n        whereDefinitionArray.push(ubigeo_dc);\r\n\r\n        var whereDefinition = whereDefinitionArray.join(' and ');\r\n        console.log(whereDefinition)\r\n\r\n        // Filtro a capa DC visible en la TOC\r\n        var id = self_cw.config.layer_id_dc;\r\n        var feature = self_cw.layersMap.getLayerInfoById(id);\r\n        feature.setFilter(whereDefinition);\r\n        feature.show();\r\n\r\n        // Filtro a capa DC sistema no visible en la TOC\r\n        var id_sys = self_cw.config.layer_id_dc_sys;\r\n        var feature_sys = self_cw.layersMap.getLayerInfoById(id_sys);\r\n        feature_sys.setFilter(whereDefinition);\r\n        feature_sys.show();\r\n\r\n        // Realizando el query a la capa\r\n        feature.layerObject.queryFeatures(whereDefinition, function(result) {\r\n            var rowcount = result.features.length;\r\n            if (rowcount) {\r\n                self_cw.controller_layer_query = true;\r\n            }\r\n            self_cw.ap_indicador_resultados_cw.innerText = rowcount;\r\n            self_cw.ap_titulo_resultados_cw.innerText = self_cw.titulo_consulta.innerText + ' encontrados';\r\n\r\n            var data = result.features.map((i) => i.attributes);\r\n\r\n            self_cw._populateResultsDC(data)\r\n\r\n            self_cw.ap_none_resultados_opcion_cw.hidden = true;\r\n            var class_list_container_resultados = self_cw.container_resultados_opcion_cw.classList;\r\n            if (!class_list_container_resultados.contains('active')) {\r\n                self_cw.container_resultados_opcion_cw.classList.toggle('active');\r\n            }\r\n            self_cw.ap_resultados_cw.click();\r\n\r\n        });\r\n\r\n        feature_sys.layerObject.queryExtent(whereDefinition, (results) => {\r\n            if (results.count) {\r\n                self_cw.map.setExtent(results.extent, true);\r\n            }\r\n        })\r\n    },\r\n\r\n    _applyQueryDM() {\r\n        whereDefinitionArray = []\r\n        var codigou_dm = `(upper(${self_cw.field_codigou_dm}) like upper('%${self_cw.input_codigou_dm_cw.value}%'))`;\r\n        var nombredm_dm = `(lower(${self_cw.field_concesion_dm}) like lower('%${self_cw.input_nombre_dm_cw.value}%'))`;\r\n        whereDefinitionArray.push(codigou_dm)\r\n        whereDefinitionArray.push(nombredm_dm)\r\n\r\n        var whereDefinition = whereDefinitionArray.join(' and ');\r\n\r\n        // console.log(whereDefinition);\r\n\r\n        // Filtro a capa DC visible en la TOC\r\n        var id = self_cw.config.layer_id_dm;\r\n        var feature = self_cw.layersMap.getLayerInfoById(id);\r\n        feature.setFilter(whereDefinition);\r\n        feature.show();\r\n\r\n        let query = new Query();\r\n        query.where = whereDefinition;\r\n\r\n        feature.getLayerObject().then(\r\n            function(response) {\r\n                response.queryFeatures(query, function(results) {\r\n                    let rowcount = results.features.length;\r\n                    self_cw.ap_indicador_resultados_cw.innerText = rowcount;\r\n                    self_cw.ap_titulo_resultados_cw.innerText = self_cw.titulo_consulta.innerText + ' encontrados';\r\n                    if (rowcount) {\r\n                        self_cw.controller_layer_query = true;\r\n                    };\r\n                    var data = results.features.map((i) => i.attributes);\r\n                    self_cw._populateResultsDM(data);\r\n\r\n                    self_cw.ap_none_resultados_opcion_cw.hidden = true;\r\n                    var class_list_container_resultados = self_cw.container_resultados_opcion_cw.classList;\r\n                    if (!class_list_container_resultados.contains('active')) {\r\n                        self_cw.container_resultados_opcion_cw.classList.toggle('active');\r\n                    }\r\n                    self_cw.ap_resultados_cw.click();\r\n\r\n                }, function(error) {\r\n                    self_cw._showMessage(`${self_cw.nls.error_query_feature} ${feature.title} (${query.where})\\n${error.message}`)\r\n                    self_cw.busyIndicator.hide();\r\n                });\r\n                response.queryExtent(query, function(results) {\r\n                    if (results.count) {\r\n                        self_cw.map.setExtent(results.extent, true)\r\n                    } else {\r\n                        self_cw._showMessage(self_cw.nls.none_element_pl);\r\n                    }\r\n                }, function(error) {\r\n                    self_cw._showMessage(`${self_cw.nls.error_query_feature} ${feature.title} (${query.where})\\n${error.message}`);\r\n                })\r\n            },\r\n            function(error) {\r\n                self_cw._showMessage(`${self_cw.nls.error_service} ${feature.title}\\n${error.message}`, type = 'error');\r\n                self_cw.busyIndicator.hide();\r\n            }\r\n        )\r\n    },\r\n\r\n    startup() {\r\n        this.inherited(arguments);\r\n        console.log('Consulta_wgt::startup');\r\n        this.busyIndicator = BusyIndicator.create({\r\n            target: this.domNode.parentNode.parentNode.parentNode,\r\n            backgroundOpacity: 0\r\n        });\r\n        this.busyIndicator.show();\r\n        self_cw._addEventToTabsOptions();\r\n        self_cw._addEventToLayerQuery();\r\n        self_cw._getDataByTipoPersona();\r\n        self_cw._getDataByDepartamento()\r\n        this.busyIndicator.hide();\r\n    },\r\n    onOpen() {\r\n        console.log('Consulta_wgt::onOpen');\r\n    },\r\n\r\n    _cleanMap() {\r\n        this.busyIndicator.show()\r\n        this.map.graphics.clear();\r\n        let whereDefinition = '1=1'\r\n        lyr_dc = this.layersMap.getLayerInfoById(this.config.layer_id_dc);\r\n        lyr_dc_sys = this.layersMap.getLayerInfoById(this.config.layer_id_dc_sys);\r\n        lyr_dm = this.layersMap.getLayerInfoById(this.config.layer_id_dm);\r\n        lyr_dc.hide();\r\n        lyr_dc_sys.hide();\r\n        lyr_dm.hide();\r\n        lyr_dc.setFilter(whereDefinition);\r\n        lyr_dc_sys.setFilter(whereDefinition);\r\n        lyr_dm.setFilter(whereDefinition);\r\n        this.busyIndicator.hide()\r\n        this.container_resultados_opcion_cw.classList.remove('active');\r\n        this.ap_none_resultados_opcion_cw.hidden = false;\r\n        this.controller_layer_query = false;\r\n    },\r\n\r\n    onClose() {\r\n        console.log('Consulta_wgt::onClose');\r\n        if (this.controller_layer_query) {\r\n            this._showMessage(this.nls.clean_map_question, type = 'question')\r\n        }\r\n    },\r\n    // onMinimize(){\r\n    //   console.log('Consulta_wgt::onMinimize');\r\n    // },\r\n    // onMaximize(){\r\n    //   console.log('Consulta_wgt::onMaximize');\r\n    // },\r\n    // onSignIn(credential){\r\n    //   console.log('Consulta_wgt::onSignIn', credential);\r\n    // },\r\n    // onSignOut(){\r\n    //   console.log('Consulta_wgt::onSignOut');\r\n    // }\r\n    // onPositionChange(){\r\n    //   console.log('Consulta_wgt::onPositionChange');\r\n    // },\r\n    // resize(){\r\n    //   console.log('Consulta_wgt::resize');\r\n    // }\r\n});"]}